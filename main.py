import connect4
import population

def main():
    board = connect4.createBoard()
    units = population.initializePopulation()
    runEP(units, board)

def playUnit(unitString):
    unit = population.loadUnit(unitString)
    board = connect4.createBoard()
    playGameTest(board, unit)


def playGameTest(board, unit):
    print(connect4.printBoard(board))
    while True:
        placement = int(input("team 1: "))
        full = not connect4.place(board, 1, placement)
        print(connect4.printBoard(board))
        if full:
            print("full board")
            break
        if connect4.checkWin(board) == 1:
            print("player 1 wins")
            break
        placement, states = population.decideMove(unit, board)
        full = not connect4.place(board, 2, placement)
        print(connect4.printBoard(board))
        print(states)
        if full:
            print("full board")
            break
        if connect4.checkWin(board) == 2:
            print("player 2 wins")
            break
    print(connect4.checkThrees(board, 1))
    print(connect4.checkThrees(board, 2))


def runEP(units, board):
    unitPopulation = units
    generations = 40
    for g in range(generations):
        population.getFitnesses(unitPopulation)
        population.repopulate(unitPopulation, g + 1)
        print(g)
    file = open("savedUnits.txt", "a")
    for u in unitPopulation:
        file.write(population.saveUnit(u) + "\n")
    file.close()

if __name__ == '__main__':
    main()
    # playUnit("19948|14|300|[1[137,24,146]]|[2[87,24,245]]|[2[24,29,3]]|[3[120,107,57]]|[5[5,68,37]]|[3[162,52,63]]|[3[63,167,264]]|[5[6,19,127]]|[0[24,131,244]]|[2[198,122,3]]|[3[86,129,246]]|[1[59,97,191]]|[1[256,27,42]]|[0[157,75,25]]|[2[2,181,116]]|[3[71,202,11]]|[1[22,116,57]]|[6[131,96,35]]|[2[81,41,97]]|[5[198,47,106]]|[4[2,172,167]]|[2[57,2,47]]|[6[234,17,136]]|[3[74,73,124]]|[1[6,16,40]]|[0[30,197,82]]|[2[281,108,21]]|[1[192,55,49]]|[2[150,7,28]]|[1[36,205,123]]|[0[208,129,275]]|[2[99,80,3]]|[1[169,26,31]]|[4[81,108,169]]|[6[73,200,37]]|[0[121,46,15]]|[3[60,19,110]]|[2[191,187,16]]|[5[207,162,37]]|[6[8,51,250]]|[1[21,134,37]]|[6[104,53,65]]|[6[104,122,176]]|[0[104,5,94]]|[4[36,196,99]]|[0[90,94,14]]|[1[107,246,169]]|[3[105,267,37]]|[2[259,99,271]]|[3[8,185,60]]|[6[82,108,251]]|[6[4,235,67]]|[1[124,185,89]]|[4[268,233,233]]|[1[104,18,86]]|[2[215,42,164]]|[3[37,154,260]]|[4[63,115,15]]|[1[187,0,3]]|[5[17,129,215]]|[4[33,80,100]]|[6[104,97,156]]|[0[81,187,149]]|[6[45,68,14]]|[1[57,70,25]]|[2[57,155,195]]|[5[281,247,183]]|[5[215,148,114]]|[0[57,96,45]]|[1[205,51,114]]|[6[38,57,218]]|[2[104,73,33]]|[2[19,89,133]]|[6[3,197,37]]|[5[222,44,47]]|[2[30,100,219]]|[6[88,107,148]]|[3[238,29,34]]|[2[126,129,7]]|[6[1,19,175]]|[4[223,146,40]]|[0[222,202,47]]|[0[8,12,75]]|[3[90,102,170]]|[6[236,115,187]]|[2[189,10,83]]|[1[208,115,31]]|[2[123,31,64]]|[5[96,42,249]]|[4[170,35,247]]|[5[100,51,138]]|[3[99,120,100]]|[0[8,36,37]]|[1[122,197,40]]|[3[204,188,167]]|[1[79,132,23]]|[2[75,2,211]]|[4[35,251,45]]|[0[43,123,84]]|[6[99,181,58]]|[4[173,43,278]]|[2[90,108,79]]|[5[87,29,22]]|[3[220,49,149]]|[1[80,89,3]]|[2[57,26,146]]|[2[54,255,33]]|[3[127,108,59]]|[2[61,16,95]]|[2[40,171,251]]|[1[10,78,173]]|[3[104,222,72]]|[6[189,152,103]]|[2[179,65,153]]|[0[20,34,44]]|[1[10,159,62]]|[0[59,37,40]]|[4[207,108,51]]|[6[165,34,122]]|[4[16,112,4]]|[3[240,129,232]]|[3[18,42,104]]|[6[100,199,31]]|[6[186,234,71]]|[0[27,117,40]]|[6[136,96,38]]|[0[100,68,69]]|[0[13,206,71]]|[6[13,68,18]]|[4[144,129,64]]|[5[54,25,84]]|[1[59,3,75]]|[2[233,140,159]]|[6[99,140,83]]|[1[110,115,78]]|[6[185,40,63]]|[2[37,199,157]]|[6[51,46,109]]|[0[128,32,10]]|[1[31,137,111]]|[1[227,4,37]]|[1[8,48,33]]|[1[136,4,4]]|[5[54,222,146]]|[1[70,5,121]]|[4[33,178,183]]|[3[193,134,210]]|[0[142,115,73]]|[3[34,87,173]]|[0[95,119,156]]|[0[286,121,162]]|[5[124,224,108]]|[6[134,145,35]]|[1[20,167,37]]|[3[141,236,3]]|[1[140,109,60]]|[3[20,55,13]]|[6[233,18,63]]|[5[104,182,3]]|[3[108,6,65]]|[1[172,75,124]]|[3[96,3,74]]|[4[267,65,49]]|[2[258,28,109]]|[0[126,102,157]]|[1[87,7,98]]|[3[4,96,149]]|[5[234,217,100]]|[3[235,227,93]]|[3[5,138,125]]|[5[159,27,37]]|[5[25,237,38]]|[6[17,108,214]]|[4[207,73,209]]|[0[137,48,50]]|[0[0,145,133]]|[2[128,96,88]]|[1[110,129,229]]|[5[180,162,182]]|[4[199,121,235]]|[0[2,50,80]]|[3[32,128,162]]|[3[46,149,264]]|[5[38,36,106]]|[5[124,80,74]]|[2[27,203,106]]|[0[152,179,87]]|[3[91,186,137]]|[0[119,111,117]]|[4[16,137,3]]|[5[168,89,203]]|[4[170,34,89]]|[0[105,51,144]]|[5[185,84,44]]|[0[108,224,225]]|[0[167,91,22]]|[3[76,133,162]]|[0[29,183,52]]|[6[63,13,31]]|[5[152,129,97]]|[1[228,38,46]]|[2[14,203,154]]|[4[38,274,266]]|[2[268,108,284]]|[6[99,154,72]]|[3[9,41,240]]|[6[63,203,211]]|[3[153,12,98]]|[0[170,146,133]]|[0[51,157,93]]|[4[237,64,82]]|[1[136,285,18]]|[4[245,116,61]]|[4[79,157,42]]|[5[105,108,58]]|[5[5,107,258]]|[4[102,63,43]]|[1[212,175,161]]|[1[151,162,37]]|[6[27,36,47]]|[0[157,74,126]]|[3[226,87,5]]|[0[206,125,80]]|[2[104,56,171]]|[4[78,44,177]]|[4[139,36,4]]|[6[138,118,67]]|[6[29,186,211]]|[5[145,6,136]]|[4[212,212,187]]|[3[172,181,242]]|[5[224,96,30]]|[3[80,138,43]]|[5[90,214,233]]|[2[113,4,176]]|[0[56,133,101]]|[4[209,75,262]]|[4[228,151,151]]|[3[250,129,256]]|[2[8,96,36]]|[6[118,228,132]]|[6[17,250,30]]|[4[3,62,119]]|[6[115,105,168]]|[1[274,43,98]]|[2[212,231,166]]|[3[141,178,49]]|[4[131,236,244]]|[2[32,185,230]]|[2[62,29,97]]|[0[250,225,114]]|[4[89,193,181]]|[3[140,112,111]]|[2[180,246,66]]|[3[32,132,11]]|[5[207,29,239]]|[2[283,176,146]]|[0[220,63,40]]|[3[12,87,19]]|[6[119,55,27]]|[6[130,6,108]]|[5[198,226,223]]|[3[196,160,99]]|[4[212,144,61]]|[6[20,0,213]]|[1[114,146,84]]|[2[104,99,193]]|[0[184,72,75]]|[3[37,122,51]]|[0[155,148,50]]|[6[236,193,204]]|[5[189,135,263]]|[1[195,227,33]]|[3[202,240,8]]|[4[174,135,142]]|[4[234,190,200]]|[1[195,141,22]]|[0[69,165,268]]|[0[38,219,224]]|[4[262,110,143]]|[1[153,147,110]]|[1[52,26,279]]|[2[2,113,84]]|[0[130,99,181]]|[6[0,125,72]]|[6[85,17,48]]|[4[17,225,39]]|[4[282,177,8]]|[6[180,271,175]]|[2[40,291,177]]|[4[255,176,154]]|[5[27,167,176]]|[3[23,33,191]]|[5[234,98,69]]|[3[287,270,283]]|[4[251,10,276]]|[2[102,267,158]]|[2[174,145,156]]|[4[144,278,164]]|[1[45,58,146]]")